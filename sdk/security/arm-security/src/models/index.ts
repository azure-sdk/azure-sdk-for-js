/*
 * Copyright (c) Microsoft Corporation.
 * Licensed under the MIT License.
 *
 * Code generated by Microsoft (R) AutoRest Code Generator.
 * Changes may cause incorrect behavior and will be lost if the code is regenerated.
 */

import * as coreClient from "@azure/core-client";

/** A vulnerability assessment scan record. */
export interface ScanV2 {
  /** Resource Id. */
  id?: string;
  /** Resource name. */
  name?: string;
  /** Resource type. */
  type?: string;
  /** A vulnerability assessment scan record properties. */
  properties?: ScanPropertiesV2;
}

/** A vulnerability assessment scan record properties. */
export interface ScanPropertiesV2 {
  /** The scan trigger type. */
  triggerType?: ScanTriggerType;
  /** The scan status. */
  state?: ScanState;
  /** The server name. */
  server?: string;
  /** The database name. */
  database?: string;
  /** The SQL version. */
  sqlVersion?: string;
  /** The scan start time (UTC). */
  startTime?: Date;
  /** Scan results are valid until end time (UTC). */
  endTime?: Date;
  /** The number of failed rules with high severity. */
  highSeverityFailedRulesCount?: number;
  /** The number of failed rules with medium severity. */
  mediumSeverityFailedRulesCount?: number;
  /** The number of failed rules with low severity. */
  lowSeverityFailedRulesCount?: number;
  /** The number of total passed rules. */
  totalPassedRulesCount?: number;
  /** The number of total failed rules. */
  totalFailedRulesCount?: number;
  /** The number of total rules assessed. */
  totalRulesCount?: number;
  /** Baseline created for this database, and has one or more rules. */
  isBaselineApplied?: boolean;
  /** Last scan time. */
  lastScanTime?: Date;
}

/** Common error response for all Azure Resource Manager APIs to return error details for failed operations. (This also follows the OData error response format.). */
export interface CloudError {
  /**
   * The error code.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly code?: string;
  /**
   * The error message.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly message?: string;
  /**
   * The error target.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly target?: string;
  /**
   * The error details.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly details?: CloudErrorBody[];
  /**
   * The error additional info.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly additionalInfo?: ErrorAdditionalInfo[];
}

/** The error detail. */
export interface CloudErrorBody {
  /**
   * The error code.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly code?: string;
  /**
   * The error message.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly message?: string;
  /**
   * The error target.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly target?: string;
  /**
   * The error details.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly details?: CloudErrorBody[];
  /**
   * The error additional info.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly additionalInfo?: ErrorAdditionalInfo[];
}

/** The resource management error additional info. */
export interface ErrorAdditionalInfo {
  /**
   * The additional info type.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly type?: string;
  /**
   * The additional info.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly info?: Record<string, unknown>;
}

export interface ScansV2 {
  /** List of vulnerability assessment scan records. */
  value?: ScanV2[];
}

/** Known values of {@link ScanTriggerType} that the service accepts. */
export enum KnownScanTriggerType {
  /** OnDemand */
  OnDemand = "OnDemand",
  /** Recurring */
  Recurring = "Recurring"
}

/**
 * Defines values for ScanTriggerType. \
 * {@link KnownScanTriggerType} can be used interchangeably with ScanTriggerType,
 *  this enum contains the known values that the service supports.
 * ### Known values supported by the service
 * **OnDemand**: OnDemand \
 * **Recurring**: Recurring
 */
export type ScanTriggerType = string;

/** Known values of {@link ScanState} that the service accepts. */
export enum KnownScanState {
  /** Failed */
  Failed = "Failed",
  /** FailedToRun */
  FailedToRun = "FailedToRun",
  /** InProgress */
  InProgress = "InProgress",
  /** Passed */
  Passed = "Passed"
}

/**
 * Defines values for ScanState. \
 * {@link KnownScanState} can be used interchangeably with ScanState,
 *  this enum contains the known values that the service supports.
 * ### Known values supported by the service
 * **Failed**: Failed \
 * **FailedToRun**: FailedToRun \
 * **InProgress**: InProgress \
 * **Passed**: Passed
 */
export type ScanState = string;

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentScansGetOptionalParams
  extends coreClient.OperationOptions {}

/** Contains response data for the get operation. */
export type SqlVulnerabilityAssessmentScansGetResponse = ScanV2;

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentScansListOptionalParams
  extends coreClient.OperationOptions {}

/** Contains response data for the list operation. */
export type SqlVulnerabilityAssessmentScansListResponse = ScansV2;

/** Optional parameters. */
export interface SecurityCenterOptionalParams
  extends coreClient.ServiceClientOptions {
  /** server parameter */
  $host?: string;
  /** Api Version */
  apiVersion?: string;
  /** Overrides client endpoint. */
  endpoint?: string;
}
