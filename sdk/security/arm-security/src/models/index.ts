/*
 * Copyright (c) Microsoft Corporation.
 * Licensed under the MIT License.
 *
 * Code generated by Microsoft (R) AutoRest Code Generator.
 * Changes may cause incorrect behavior and will be lost if the code is regenerated.
 */

import * as coreClient from "@azure/core-client";

/** Rule results input. */
export interface RuleResultsInput {
  /** Take results from latest scan. */
  latestScan?: boolean;
  /**
   * Expected results to be inserted into the baseline.
   * Leave this field empty it LatestScan == true.
   */
  results?: string[][];
}

/** Rule results properties. */
export interface RuleResultsProperties {
  /** Expected results in the baseline. */
  results?: string[][];
}

/** Describes an Azure resource. */
export interface Resource {
  /**
   * Resource Id
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly id?: string;
  /**
   * Resource name
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly name?: string;
  /**
   * Resource type
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly type?: string;
}

/** Common error response for all Azure Resource Manager APIs to return error details for failed operations. (This also follows the OData error response format.). */
export interface CloudError {
  /**
   * The error code.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly code?: string;
  /**
   * The error message.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly message?: string;
  /**
   * The error target.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly target?: string;
  /**
   * The error details.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly details?: CloudErrorBody[];
  /**
   * The error additional info.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly additionalInfo?: ErrorAdditionalInfo[];
}

/** The error detail. */
export interface CloudErrorBody {
  /**
   * The error code.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly code?: string;
  /**
   * The error message.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly message?: string;
  /**
   * The error target.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly target?: string;
  /**
   * The error details.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly details?: CloudErrorBody[];
  /**
   * The error additional info.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly additionalInfo?: ErrorAdditionalInfo[];
}

/** The resource management error additional info. */
export interface ErrorAdditionalInfo {
  /**
   * The additional info type.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly type?: string;
  /**
   * The additional info.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly info?: Record<string, unknown>;
}

/** A list of rules results. */
export interface RulesResults {
  /** List of rule results. */
  value?: RuleResults[];
}

/** Rules results input. */
export interface RulesResultsInput {
  /** Take results from latest scan. */
  latestScan?: boolean;
  /**
   * Expected results to be inserted into the baseline.
   * Leave this field empty it LatestScan == true.
   */
  results?: { [propertyName: string]: string[][] };
}

/** A vulnerability assessment scan record properties. */
export interface ScanPropertiesV2 {
  /** The scan trigger type. */
  triggerType?: ScanTriggerType;
  /** The scan status. */
  state?: ScanState;
  /** The server name. */
  server?: string;
  /** The database name. */
  database?: string;
  /** The SQL version. */
  sqlVersion?: string;
  /** The scan start time (UTC). */
  startTime?: Date;
  /** Scan results are valid until end time (UTC). */
  endTime?: Date;
  /** The number of failed rules with high severity. */
  highSeverityFailedRulesCount?: number;
  /** The number of failed rules with medium severity. */
  mediumSeverityFailedRulesCount?: number;
  /** The number of failed rules with low severity. */
  lowSeverityFailedRulesCount?: number;
  /** The number of total passed rules. */
  totalPassedRulesCount?: number;
  /** The number of total failed rules. */
  totalFailedRulesCount?: number;
  /** The number of total rules assessed. */
  totalRulesCount?: number;
  /** Baseline created for this database, and has one or more rules. */
  isBaselineApplied?: boolean;
  /** Last scan time. */
  lastScanTime?: Date;
}

/** A list of vulnerability assessment scan records. */
export interface ScansV2 {
  /** List of vulnerability assessment scan records. */
  value?: ScanV2[];
}

/** A vulnerability assessment scan result properties for a single rule. */
export interface ScanResultProperties {
  /** The rule Id. */
  ruleId?: string;
  /** The rule result status. */
  status?: RuleStatus;
  /** Indicated whether the results specified here are trimmed. */
  isTrimmed?: boolean;
  /** The results of the query that was run. */
  queryResults?: string[][];
  /** Remediation details. */
  remediation?: Remediation;
  /** The rule result adjusted with baseline. */
  baselineAdjustedResult?: BaselineAdjustedResult;
  /** vulnerability assessment rule metadata details. */
  ruleMetadata?: VaRule;
}

/** Remediation details. */
export interface Remediation {
  /** Remediation description. */
  description?: string;
  /** Remediation script. */
  scripts?: string[];
  /** Is remediation automated. */
  automated?: boolean;
  /** Optional link to remediate in Azure Portal. */
  portalLink?: string;
}

/** The rule result adjusted with baseline. */
export interface BaselineAdjustedResult {
  /** Baseline details. */
  baseline?: Baseline;
  /** The rule result status. */
  status?: RuleStatus;
  /** Results the are not in baseline. */
  resultsNotInBaseline?: string[][];
  /** Results the are in baseline. */
  resultsOnlyInBaseline?: string[][];
}

/** Baseline details. */
export interface Baseline {
  /** Expected results. */
  expectedResults?: string[][];
  /** Baseline update time (UTC). */
  updatedTime?: Date;
}

/** vulnerability assessment rule metadata details. */
export interface VaRule {
  /** The rule Id. */
  ruleId?: string;
  /** The rule severity. */
  severity?: RuleSeverity;
  /** The rule category. */
  category?: string;
  /** The rule type. */
  ruleType?: RuleType;
  /** The rule title. */
  title?: string;
  /** The rule description. */
  description?: string;
  /** The rule rationale. */
  rationale?: string;
  /** The rule query details. */
  queryCheck?: QueryCheck;
  /** The benchmark references. */
  benchmarkReferences?: BenchmarkReference[];
}

/** The rule query details. */
export interface QueryCheck {
  /** The rule query. */
  query?: string;
  /** Expected result. */
  expectedResult?: string[][];
  /** Column names of expected result. */
  columnNames?: string[];
}

/** The benchmark references. */
export interface BenchmarkReference {
  /** The benchmark name. */
  benchmark?: string;
  /** The benchmark reference. */
  reference?: string;
}

/** A list of vulnerability assessment scan results. */
export interface ScanResults {
  /** List of vulnerability assessment scan results. */
  value?: ScanResult[];
}

/** Rule results. */
export interface RuleResults extends Resource {
  /** Rule results properties. */
  properties?: RuleResultsProperties;
}

/** A vulnerability assessment scan record. */
export interface ScanV2 extends Resource {
  /** A vulnerability assessment scan record properties. */
  properties?: ScanPropertiesV2;
}

/** A vulnerability assessment scan result for a single rule. */
export interface ScanResult extends Resource {
  /** A vulnerability assessment scan result properties for a single rule. */
  properties?: ScanResultProperties;
}

/** Known values of {@link ScanTriggerType} that the service accepts. */
export enum KnownScanTriggerType {
  /** OnDemand */
  OnDemand = "OnDemand",
  /** Recurring */
  Recurring = "Recurring"
}

/**
 * Defines values for ScanTriggerType. \
 * {@link KnownScanTriggerType} can be used interchangeably with ScanTriggerType,
 *  this enum contains the known values that the service supports.
 * ### Known values supported by the service
 * **OnDemand**: OnDemand \
 * **Recurring**: Recurring
 */
export type ScanTriggerType = string;

/** Known values of {@link ScanState} that the service accepts. */
export enum KnownScanState {
  /** Failed */
  Failed = "Failed",
  /** FailedToRun */
  FailedToRun = "FailedToRun",
  /** InProgress */
  InProgress = "InProgress",
  /** Passed */
  Passed = "Passed"
}

/**
 * Defines values for ScanState. \
 * {@link KnownScanState} can be used interchangeably with ScanState,
 *  this enum contains the known values that the service supports.
 * ### Known values supported by the service
 * **Failed**: Failed \
 * **FailedToRun**: FailedToRun \
 * **InProgress**: InProgress \
 * **Passed**: Passed
 */
export type ScanState = string;

/** Known values of {@link RuleStatus} that the service accepts. */
export enum KnownRuleStatus {
  /** NonFinding */
  NonFinding = "NonFinding",
  /** Finding */
  Finding = "Finding",
  /** InternalError */
  InternalError = "InternalError"
}

/**
 * Defines values for RuleStatus. \
 * {@link KnownRuleStatus} can be used interchangeably with RuleStatus,
 *  this enum contains the known values that the service supports.
 * ### Known values supported by the service
 * **NonFinding**: NonFinding \
 * **Finding**: Finding \
 * **InternalError**: InternalError
 */
export type RuleStatus = string;

/** Known values of {@link RuleSeverity} that the service accepts. */
export enum KnownRuleSeverity {
  /** High */
  High = "High",
  /** Medium */
  Medium = "Medium",
  /** Low */
  Low = "Low",
  /** Informational */
  Informational = "Informational",
  /** Obsolete */
  Obsolete = "Obsolete"
}

/**
 * Defines values for RuleSeverity. \
 * {@link KnownRuleSeverity} can be used interchangeably with RuleSeverity,
 *  this enum contains the known values that the service supports.
 * ### Known values supported by the service
 * **High**: High \
 * **Medium**: Medium \
 * **Low**: Low \
 * **Informational**: Informational \
 * **Obsolete**: Obsolete
 */
export type RuleSeverity = string;

/** Known values of {@link RuleType} that the service accepts. */
export enum KnownRuleType {
  /** Binary */
  Binary = "Binary",
  /** BaselineExpected */
  BaselineExpected = "BaselineExpected",
  /** PositiveList */
  PositiveList = "PositiveList",
  /** NegativeList */
  NegativeList = "NegativeList"
}

/**
 * Defines values for RuleType. \
 * {@link KnownRuleType} can be used interchangeably with RuleType,
 *  this enum contains the known values that the service supports.
 * ### Known values supported by the service
 * **Binary**: Binary \
 * **BaselineExpected**: BaselineExpected \
 * **PositiveList**: PositiveList \
 * **NegativeList**: NegativeList
 */
export type RuleType = string;

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentBaselineRulesCreateOrUpdateOptionalParams
  extends coreClient.OperationOptions {
  /** The baseline results for this rule. */
  body?: RuleResultsInput;
}

/** Contains response data for the createOrUpdate operation. */
export type SqlVulnerabilityAssessmentBaselineRulesCreateOrUpdateResponse = RuleResults;

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentBaselineRulesGetOptionalParams
  extends coreClient.OperationOptions {}

/** Contains response data for the get operation. */
export type SqlVulnerabilityAssessmentBaselineRulesGetResponse = RuleResults;

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentBaselineRulesDeleteOptionalParams
  extends coreClient.OperationOptions {}

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentBaselineRulesListOptionalParams
  extends coreClient.OperationOptions {}

/** Contains response data for the list operation. */
export type SqlVulnerabilityAssessmentBaselineRulesListResponse = RulesResults;

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentBaselineRulesAddOptionalParams
  extends coreClient.OperationOptions {
  /** The baseline rules. */
  body?: RulesResultsInput;
}

/** Contains response data for the add operation. */
export type SqlVulnerabilityAssessmentBaselineRulesAddResponse = RulesResults;

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentScansGetOptionalParams
  extends coreClient.OperationOptions {}

/** Contains response data for the get operation. */
export type SqlVulnerabilityAssessmentScansGetResponse = ScanV2;

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentScansListOptionalParams
  extends coreClient.OperationOptions {}

/** Contains response data for the list operation. */
export type SqlVulnerabilityAssessmentScansListResponse = ScansV2;

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentScanResultsGetOptionalParams
  extends coreClient.OperationOptions {}

/** Contains response data for the get operation. */
export type SqlVulnerabilityAssessmentScanResultsGetResponse = ScanResult;

/** Optional parameters. */
export interface SqlVulnerabilityAssessmentScanResultsListOptionalParams
  extends coreClient.OperationOptions {}

/** Contains response data for the list operation. */
export type SqlVulnerabilityAssessmentScanResultsListResponse = ScanResults;

/** Optional parameters. */
export interface SecurityCenterOptionalParams
  extends coreClient.ServiceClientOptions {
  /** server parameter */
  $host?: string;
  /** Api Version */
  apiVersion?: string;
  /** Overrides client endpoint. */
  endpoint?: string;
}
